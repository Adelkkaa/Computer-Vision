
## üîπ **–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ K-Means**
–ú–µ—Ç–æ–¥ **K-Means** ‚Äî —ç—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –ø–∏–∫—Å–µ–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) –Ω–∞ `K` –≥—Ä—É–ø–ø (–∫–ª–∞—Å—Ç–µ—Ä–æ–≤).  
–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:  
1. –í—ã–±–∏—Ä–∞–µ–º `K` —Å–ª—É—á–∞–π–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.  
2. –ö–∞–∂–¥–æ–º—É –ø–∏–∫—Å–µ–ª—é **–Ω–∞–∑–Ω–∞—á–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä**, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ–Ω –±–ª–∏–∂–µ.  
3. –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Ü–µ–Ω—Ç—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ –≤—Å–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π –≤ —ç—Ç–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ.  
4. –ü–æ–≤—Ç–æ—Ä—è–µ–º –ø—Ä–æ—Ü–µ—Å—Å, –ø–æ–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä—ã –Ω–µ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—Ç—Å—è.  

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª—è—Ç—å –æ–±—ä–µ–∫—Ç—ã, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∏—Ö —Ü–≤–µ—Ç–µ.

---

## üîπ **–†–∞–∑–±–æ—Ä –∫–æ–¥–∞ –ø–æ —Å—Ç—Ä–æ—á–∫–∞–º**
```python
def kmeans_segmentation(image, K=2):
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `kmeans_segmentation`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:  
  - `image` ‚Äî –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.  
  - `K=2` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2: **–æ–±—ä–µ–∫—Ç –∏ —Ñ–æ–Ω**).  

---

### üìå **1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ø–∏—Å–æ–∫ –ø–∏–∫—Å–µ–ª–µ–π**
```python
    Z = image.reshape((-1, 3))
    Z = np.float32(Z)
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `image` –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å `(height, width, 3)`, –≥–¥–µ 3 ‚Äî —ç—Ç–æ —Ü–≤–µ—Ç–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã (RGB).  
- `reshape((-1, 3))` –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –≤ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–∏–∫—Å–µ–ª–µ–π, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ `[R, G, B]`.  
  - –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 4√ó4, —Ç–æ:
    ```python
    image.shape = (4, 4, 3)
    Z.shape = (16, 3)  # 16 –ø–∏–∫—Å–µ–ª–µ–π, –∫–∞–∂–¥—ã–π —Å 3 —Ü–≤–µ—Ç–∞–º–∏
    ```
- `np.float32(Z)` ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –≤ `float32`, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã `cv2.kmeans()`.  

---

### üìå **2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞**
```python
    criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 10, 1.0)
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- K-Means —Ä–∞–±–æ—Ç–∞–µ—Ç **–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ**, –∏ –Ω–∞–º –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å, –∫–æ–≥–¥–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º.  
- `cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è, –µ—Å–ª–∏:  
  1. –õ–∏–±–æ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Ç–µ—Ä–∞—Ü–∏–π** (`10`).  
  2. –õ–∏–±–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —Å—Ç–∞–Ω–µ—Ç –º–µ–Ω—å—à–µ –ø–æ—Ä–æ–≥–∞ `1.0` (–ø–æ—á—Ç–∏ –Ω–µ –¥–≤–∏–≥–∞—é—Ç—Å—è).  

---

### üìå **3. –ó–∞–ø—É—Å–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-Means**
```python
    ret, label, center = cv2.kmeans(Z, K, None, criteria, 10, cv2.KMEANS_RANDOM_CENTERS)
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –í—ã–∑—ã–≤–∞–µ—Ç `cv2.kmeans()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
  - `Z` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–∏–∫—Å–µ–ª–µ–π.  
  - `K` ‚Äî —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (2, –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω–æ –¥—Ä—É–≥–æ–µ).  
  - `None` ‚Äî –≤–º–µ—Å—Ç–æ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–∫ (–ø—É—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –∏—Ö —Å–∞–º –≤—ã–±–∏—Ä–∞–µ—Ç).  
  - `criteria` ‚Äî –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.  
  - `10` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞).  
  - `cv2.KMEANS_RANDOM_CENTERS` ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ.  

**üìå –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç?**
- `ret` ‚Äî —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –æ—Ç —Ç–æ—á–µ–∫ –¥–æ —Ü–µ–Ω—Ç—Ä–æ–≤ –∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.  
- `label` ‚Äî –º–∞—Å—Å–∏–≤ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è (`0` –∏–ª–∏ `1`).  
- `center` ‚Äî –º–∞—Å—Å–∏–≤ —Å–æ —Å—Ä–µ–¥–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ü–≤–µ—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å `(K, 3)`).  

–ü—Ä–∏–º–µ—Ä:  
```python
label = [0, 1, 0, 0, 1, 1, 0, ...]  # –ö –∫–∞–∂–¥–æ–º—É –ø–∏–∫—Å–µ–ª—é –ø—Ä–∏—Å–≤–æ–µ–Ω –∫–ª–∞—Å—Ç–µ—Ä
center = [[120, 120, 120], [255, 255, 255]]  # –î–≤–∞ —Ü–≤–µ—Ç–∞ (—Å–µ—Ä—ã–π –∏ –±–µ–ª—ã–π)
```

---

### üìå **4. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**
```python
    center = np.uint8(center)
    res = center[label.flatten()]
    res2 = res.reshape((image.shape))
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `np.uint8(center)` ‚Äî –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Ü–µ–Ω—Ç—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ –≤ `uint8`, —á—Ç–æ–±—ã –æ–Ω–∏ —Å—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏.  
- `label.flatten()` ‚Äî –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç `label` –≤ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.  
- `res = center[label.flatten()]` ‚Äî –∫–∞–∂–¥–æ–º—É –ø–∏–∫—Å–µ–ª—é –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Ü–≤–µ—Ç –µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞.  
- `res.reshape((image.shape))` ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä.  

–¢–µ–ø–µ—Ä—å `res2` ‚Äî —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≥–¥–µ –∫–∞–∂–¥—ã–π –ø–∏–∫—Å–µ–ª—å –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —Å—Ä–µ–¥–Ω–∏–π —Ü–≤–µ—Ç –µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞.  

---

### üìå **5. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –∫–∞–∫–æ–π —Ü–≤–µ—Ç ‚Äî –æ–±—ä–µ–∫—Ç, –∞ –∫–∞–∫–æ–π ‚Äî —Ñ–æ–Ω**
```python
    if center[0].mean() < center[1].mean():
        object_color = np.array([255, 0, 0], dtype=np.uint8)  # –°–∏–Ω–∏–π
        background_color = np.array([0, 0, 255], dtype=np.uint8)  # –ö—Ä–∞—Å–Ω—ã–π
    else:
        object_color = np.array([0, 0, 255], dtype=np.uint8)  # –ö—Ä–∞—Å–Ω—ã–π
        background_color = np.array([255, 0, 0], dtype=np.uint8)  # –°–∏–Ω–∏–π
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `center[0].mean()` –∏ `center[1].mean()` –≤—ã—á–∏—Å–ª—è—é—Ç **—Å—Ä–µ–¥–Ω—é—é —è—Ä–∫–æ—Å—Ç—å** —Ü–≤–µ—Ç–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.  
- –ï—Å–ª–∏ `center[0]` —Ç–µ–º–Ω–µ–µ `center[1]`, —Ç–æ –æ–Ω —Å—á–∏—Ç–∞–µ—Ç—Å—è **–æ–±—ä–µ–∫—Ç–æ–º** (—Å–∏–Ω–∏–π).  
- –ï—Å–ª–∏ `center[0]` —Å–≤–µ—Ç–ª–µ–µ, —Ç–æ –Ω–∞–æ–±–æ—Ä–æ—Ç.  

---

### üìå **6. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ü–≤–µ—Ç–∞–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏**
```python
    segmented_image = np.zeros_like(image, dtype=np.uint8)
    segmented_image[label.reshape(image.shape[:2]) == 0] = object_color
    segmented_image[label.reshape(image.shape[:2]) == 1] = background_color
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
1. –°–æ–∑–¥–∞—ë—Ç –ø—É—Å—Ç–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ `segmented_image` —Ç–∞–∫–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞, –∫–∞–∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ, –Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –Ω—É–ª—è–º–∏ (—á—ë—Ä–Ω—ã–π —Ñ–æ–Ω).  
2. –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –≤—Å–µ–º –ø–∏–∫—Å–µ–ª—è–º **–∫–ª–∞—Å—Ç–µ—Ä–∞ 0** (–æ–±—ä–µ–∫—Ç) **—Ü–≤–µ—Ç `object_color`**.  
3. –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –≤—Å–µ–º –ø–∏–∫—Å–µ–ª—è–º **–∫–ª–∞—Å—Ç–µ—Ä–∞ 1** (—Ñ–æ–Ω) **—Ü–≤–µ—Ç `background_color`**.  

---

### üìå **7. –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**
```python
    return segmented_image
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–æ–∫—Ä–∞—à–µ–Ω–Ω–æ–µ** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≥–¥–µ:
  - **–û–±—ä–µ–∫—Ç** (—Ç—ë–º–Ω—ã–π) ‚Äî —Å–∏–Ω–∏–π.  
  - **–§–æ–Ω** (—Å–≤–µ—Ç–ª—ã–π) ‚Äî –∫—Ä–∞—Å–Ω—ã–π.  

---

## üîπ **–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã**
### üì∏ –í—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
–û–±—ã—á–Ω–∞—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è.

### üîπ –ü–æ—Å–ª–µ K-Means:
- –§–æ–Ω **–∫—Ä–∞—Å–Ω—ã–π**.
- –û–±—ä–µ–∫—Ç **—Å–∏–Ω–∏–π**.

–¢–∞–∫–æ–π –º–µ—Ç–æ–¥ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ —Ü–≤–µ—Ç—É.

---

## üéØ **–í—ã–≤–æ–¥**
–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ **—Ä–∞–∑–¥–µ–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ 2 —Ü–≤–µ—Ç–∞**, –∏—Å–ø–æ–ª—å–∑—É—è –∞–ª–≥–æ—Ä–∏—Ç–º **K-Means**. –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:  
1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ø–∏—Å–æ–∫ –ø–∏–∫—Å–µ–ª–µ–π.  
2. –ó–∞–ø—É—Å–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ `cv2.kmeans()`.  
3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –∫–∞–∫–æ–π —Ü–≤–µ—Ç ‚Äî –æ–±—ä–µ–∫—Ç, –∞ –∫–∞–∫–æ–π ‚Äî —Ñ–æ–Ω.  
4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –æ–∫—Ä–∞—Å–∫–æ–π.  
