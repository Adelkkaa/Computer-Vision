## üîπ **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `grabcut_segmentation`?**
–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç **—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**, –∏—Å–ø–æ–ª—å–∑—É—è –∞–ª–≥–æ—Ä–∏—Ç–º **GrabCut**.  
–ê–ª–≥–æ—Ä–∏—Ç–º –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ **–≥—Ä–∞—Ñ–æ–≤—ã—Ö —Ä–∞–∑—Ä–µ–∑–∞—Ö** –∏ —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ **—Ñ–æ–Ω** –∏ **–æ–±—ä–µ–∫—Ç**, —É–ª—É—á—à–∞—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π.

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:  
1. **–ó–∞–¥–∞—ë–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å**, –≥–¥–µ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–±—ä–µ–∫—Ç.  
2. **GrabCut –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**, —Å–æ–∑–¥–∞—ë—Ç –º–æ–¥–µ–ª—å —Ñ–æ–Ω–∞ –∏ –æ–±—ä–µ–∫—Ç–∞.  
3. **–ê–ª–≥–æ—Ä–∏—Ç–º –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É—Ç–æ—á–Ω—è–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –æ–±—ä–µ–∫—Ç–∞**.  
4. **–í—ã—Ö–æ–¥ ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≥–¥–µ —Ñ–æ–Ω —É–¥–∞–ª—ë–Ω** (–∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —á—ë—Ä–Ω—ã–π).  

---

## üîπ **–†–∞–∑–±–æ—Ä –∫–æ–¥–∞ –ø–æ —Å—Ç—Ä–æ—á–∫–∞–º**
```python
def grabcut_segmentation(image):
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `grabcut_segmentation`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `image` (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ NumPy).  

---

### üìå **1. –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**
```python
    mask = np.zeros(image.shape[:2], np.uint8)
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –°–æ–∑–¥–∞—ë—Ç **–º–∞—Å–∫—É** `mask` —Ä–∞–∑–º–µ—Ä–æ–º `(height, width)`, –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é –Ω—É–ª—è–º–∏ (`0` –æ–∑–Ω–∞—á–∞–µ—Ç —Ñ–æ–Ω).  
- `image.shape[:2]` –¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ **–≤—ã—Å–æ—Ç—É –∏ —à–∏—Ä–∏–Ω—É** (–±–µ–∑ —Ü–≤–µ—Ç–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤).  
- `np.uint8` –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `cv2.grabCut()` (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ 0‚Äì255).  

üìå **–ú–∞—Å–∫–∞ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞.**  
–í –Ω–µ–π:
- `0` ‚Äî **—Ç–æ—á–Ω–æ —Ñ–æ–Ω**.  
- `1` ‚Äî **—Ç–æ—á–Ω–æ –æ–±—ä–µ–∫—Ç**.  
- `2` ‚Äî **–≤–æ–∑–º–æ–∂–Ω—ã–π —Ñ–æ–Ω**.  
- `3` ‚Äî **–≤–æ–∑–º–æ–∂–Ω—ã–π –æ–±—ä–µ–∫—Ç**.  

---

### üìå **2. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Ñ–æ–Ω–∞ –∏ –æ–±—ä–µ–∫—Ç–∞**
```python
    bgd_model = np.zeros((1, 65), np.float64)
    fgd_model = np.zeros((1, 65), np.float64)
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –°–æ–∑–¥–∞—ë—Ç –¥–≤–∞ –º–∞—Å—Å–∏–≤–∞ **–¥–ª—è –º–æ–¥–µ–ª–∏ —Ñ–æ–Ω–∞ (`bgd_model`) –∏ –æ–±—ä–µ–∫—Ç–∞ (`fgd_model`)**.  
- `cv2.grabCut()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≥–∞—É—Å—Å–æ–≤—ã–µ —Å–º–µ—Å–∏** (GMM) –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Ü–≤–µ—Ç–∞ —Ñ–æ–Ω–∞ –∏ –æ–±—ä–µ–∫—Ç–∞.  
- –ö–∞–∂–¥—ã–π –º–∞—Å—Å–∏–≤ `(1, 65)` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç—Ç–∏—Ö –º–æ–¥–µ–ª–µ–π.  

üìå **–ü–æ—á–µ–º—É (1, 65)?**  
- 5 –≥–∞—É—Å—Å–æ–≤—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π **√ó 13 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** = `65` –∑–Ω–∞—á–µ–Ω–∏–π.  
- `np.float64` ‚Äî –Ω—É–∂–µ–Ω –¥–ª—è —Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.  

---

### üìå **3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ (ROI)**
```python
    rect = (50, 50, image.shape[1] - 100, image.shape[0] - 100)
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –ó–∞–¥–∞—ë—Ç **–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫**, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç **–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π –æ–±—ä–µ–∫—Ç**.  
- `(50, 50)` ‚Äî –≤–µ—Ä—Ö–Ω–∏–π –ª–µ–≤—ã–π —É–≥–æ–ª.  
- `(image.shape[1] - 100, image.shape[0] - 100)` ‚Äî —à–∏—Ä–∏–Ω–∞ –∏ –≤—ã—Å–æ—Ç–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞, **—Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏** –æ—Ç –∫—Ä–∞—ë–≤.  

üìå **–≠—Ç–æ—Ç –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –≥–æ–≤–æ—Ä–∏—Ç GrabCut:**  
üëâ –í—Å—ë –≤–Ω—É—Ç—Ä–∏ ‚Äî **—Å–∫–æ—Ä–µ–µ –æ–±—ä–µ–∫—Ç**, –∞ —Å–Ω–∞—Ä—É–∂–∏ ‚Äî **—Ñ–æ–Ω**.  

---

### üìå **4. –ó–∞–ø—É—Å–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ GrabCut**
```python
    cv2.grabCut(image, mask, rect, bgd_model, fgd_model, 5, cv2.GC_INIT_WITH_RECT)
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `cv2.grabCut()` –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º GrabCut:  
  - `image` ‚Äî –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.  
  - `mask` ‚Äî –º–∞—Å–∫–∞ (–±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∞).  
  - `rect` ‚Äî –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –æ–±—ä–µ–∫—Ç.  
  - `bgd_model` / `fgd_model` ‚Äî –º–æ–¥–µ–ª–∏ —Ñ–æ–Ω–∞ –∏ –æ–±—ä–µ–∫—Ç–∞.  
  - `5` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞.  
  - `cv2.GC_INIT_WITH_RECT` ‚Äî **–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫** –∫–∞–∫ –Ω–∞—á–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –æ–±—ä–µ–∫—Ç–∞.  

üìå **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏?**  
- –ê–ª–≥–æ—Ä–∏—Ç–º —Å—Ç—Ä–æ–∏—Ç **–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—É—é –º–æ–¥–µ–ª—å** —Ñ–æ–Ω–∞ –∏ –æ–±—ä–µ–∫—Ç–∞.  
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –ø–∏–∫—Å–µ–ª–∏ **—Ç–æ—á–Ω–æ —Ñ–æ–Ω** (`0`) –∏ **—Ç–æ—á–Ω–æ –æ–±—ä–µ–∫—Ç** (`1`).  
- –ü–æ–≤—Ç–æ—Ä—è–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü **5 —Ä–∞–∑**, –æ–±–Ω–æ–≤–ª—è—è –º–∞—Å–∫—É.  

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `mask` —Å–æ–¥–µ—Ä–∂–∏—Ç:  
- `0` (`cv2.GC_BGD`) ‚Äî **—Ç–æ—á–Ω—ã–π —Ñ–æ–Ω**.  
- `1` (`cv2.GC_FGD`) ‚Äî **—Ç–æ—á–Ω—ã–π –æ–±—ä–µ–∫—Ç**.  
- `2` (`cv2.GC_PR_BGD`) ‚Äî **–≤–æ–∑–º–æ–∂–Ω—ã–π —Ñ–æ–Ω**.  
- `3` (`cv2.GC_PR_FGD`) ‚Äî **–≤–æ–∑–º–æ–∂–Ω—ã–π –æ–±—ä–µ–∫—Ç**.  

---

### üìå **5. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å–∫–∏ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞**
```python
    mask2 = np.where((mask == 2) | (mask == 0), 0, 1).astype('uint8')
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `np.where((mask == 2) | (mask == 0), 0, 1)` –∑–∞–º–µ–Ω—è–µ—Ç:  
  - `0` –∏ `2` (—Ñ–æ–Ω) ‚Üí **0 (—á—ë—Ä–Ω—ã–π)**.  
  - `1` –∏ `3` (–æ–±—ä–µ–∫—Ç) ‚Üí **1 (–±–µ–ª—ã–π)**.  
- `astype('uint8')` –¥–µ–ª–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.  

üìå **–¢–µ–ø–µ—Ä—å `mask2` ‚Äî —ç—Ç–æ –±–∏–Ω–∞—Ä–Ω–∞—è –º–∞—Å–∫–∞ –æ–±—ä–µ–∫—Ç–∞.**  
- `0` ‚Üí —Ñ–æ–Ω.  
- `1` ‚Üí –æ–±—ä–µ–∫—Ç.  

---

### üìå **6. –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**
```python
    output = image * mask2[:, :, np.newaxis]
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `mask2[:, :, np.newaxis]` –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç—Ä–µ—Ç–∏–π –∏–∑–º–µ—Ä–µ–Ω–∏–µ, –ø—Ä–µ–≤—Ä–∞—â–∞—è `(H, W)` ‚Üí `(H, W, 1)`, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —É–º–Ω–æ–∂–∏—Ç—å –Ω–∞ —Ü–≤–µ—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ `(H, W, 3)`.  
- `image * mask2[:, :, np.newaxis]` –æ—Å—Ç–∞–≤–ª—è–µ—Ç **—Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç**, –∞ —Ñ–æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `0` (—á—ë—Ä–Ω—ã–π).  

üìå **–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:**  
–ï—Å–ª–∏ `mask2 = [[1, 0], [0, 1]]`, –∞ `image = [[255, 200], [100, 50]]`, —Ç–æ:  
```python
output = image * [[1, 0], [0, 1]]  # –§–æ–Ω –∑–∞–Ω—É–ª—è–µ—Ç—Å—è
```

---

### üìå **7. –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**
```python
    return output
```
**‚û°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —É–¥–∞–ª—ë–Ω–Ω—ã–º —Ñ–æ–Ω–æ–º.  

---

## üîπ **–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã**
### üì∏ –í—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –æ–±—ä–µ–∫—Ç–æ–º –∏ —Ñ–æ–Ω–æ–º.

### üîπ –ü–æ—Å–ª–µ GrabCut:
- –§–æ–Ω **—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á—ë—Ä–Ω—ã–º**.
- –û–±—ä–µ–∫—Ç –æ—Å—Ç–∞—ë—Ç—Å—è **–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π**.

---

## üéØ **–í—ã–≤–æ–¥**
–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç**, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ **GrabCut**.  
–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:  
1. –°–æ–∑–¥–∞—ë—Ç **–º–∞—Å–∫—É** –∏ **–º–æ–¥–µ–ª–∏ —Ñ–æ–Ω–∞/–æ–±—ä–µ–∫—Ç–∞**.  
2. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç **–≥—Ä—É–±—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫**, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ–±—ä–µ–∫—Ç.  
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç **GrabCut**, —á—Ç–æ–±—ã —É—Ç–æ—á–Ω–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã.  
4. –°–æ–∑–¥–∞—ë—Ç **–±–∏–Ω–∞—Ä–Ω—É—é –º–∞—Å–∫—É**, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç.  
5. –£–±–∏—Ä–∞–µ—Ç —Ñ–æ–Ω, –¥–µ–ª–∞—è –µ–≥–æ **—á—ë—Ä–Ω—ã–º**.  
